<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title || 'Editar Tarefa' %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>‚úèÔ∏è Editar Tarefa</h1>
            <nav>
                <a href="/tasks" class="btn btn-secondary">‚Üê Voltar para Lista</a>
                <a href="/users" class="btn btn-secondary">üë§ Usu√°rios</a>
            </nav>
        </header>

        <main>
            <div class="card">
                <h2>üìù Editar Tarefa: <%= task.title %></h2>
                
                <form action="/tasks/edit/<%= task.id %>" method="POST" class="task-form">
                    <div class="form-group">
                        <label for="title">T√≠tulo da Tarefa *</label>
                        <input 
                            type="text" 
                            id="title" 
                            name="title" 
                            class="form-control" 
                            value="<%= task.title %>"
                            placeholder="Digite o t√≠tulo da tarefa"
                            required 
                        />
                    </div>

                    <div class="form-group">
                        <label for="description">Descri√ß√£o</label>
                        <textarea 
                            id="description" 
                            name="description" 
                            class="form-control" 
                            rows="4"
                            placeholder="Descreva os detalhes da tarefa"
                        ><%= task.description || '' %></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="user_id">Respons√°vel</label>
                            <select id="user_id" name="user_id" class="form-control">
                                <option value="">Selecione um usu√°rio</option>
                                <% if (typeof users !== 'undefined') { %>
                                    <% users.forEach(user => { %>
                                        <option value="<%= user.id %>" <%= task.user_id == user.id ? 'selected' : '' %>>
                                            <%= user.name %>
                                        </option>
                                    <% }) %>
                                <% } %>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="due_date">Data de Vencimento</label>
                            <input 
                                type="date" 
                                id="due_date" 
                                name="due_date" 
                                class="form-control"
                                value="<%= task.due_date ? task.due_date.toISOString().split('T')[0] : '' %>"
                            />
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input 
                                type="checkbox" 
                                name="completed" 
                                value="true"
                                <%= task.completed ? 'checked' : '' %>
                            />
                            <span class="checkmark"></span>
                            Tarefa conclu√≠da
                        </label>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            üíæ Salvar Altera√ß√µes
                        </button>
                        <a href="/tasks" class="btn btn-secondary">
                            ‚ùå Cancelar
                        </a>
                    </div>
                </form>
            </div>

            <!-- Informa√ß√µes da Tarefa -->
            <div class="card">
                <h3>‚ÑπÔ∏è Informa√ß√µes da Tarefa</h3>
                <div class="task-info">
                    <div class="info-item">
                        <strong>ID:</strong> <%= task.id %>
                    </div>
                    <div class="info-item">
                        <strong>Status:</strong> 
                        <span class="status-badge <%= task.completed ? 'completed' : 'pending' %>">
                            <%= task.completed ? '‚úÖ Conclu√≠da' : '‚è≥ Pendente' %>
                        </span>
                    </div>
                    <div class="info-item">
                        <strong>Criada em:</strong> 
                        <%= task.created_at ? new Date(task.created_at).toLocaleDateString('pt-BR') : 'Data n√£o dispon√≠vel' %>
                    </div>
                    <% if (task.due_date) { %>
                        <div class="info-item">
                            <strong>Vencimento:</strong> 
                            <span class="<%= new Date(task.due_date) < new Date() && !task.completed ? 'overdue' : '' %>">
                                <%= new Date(task.due_date).toLocaleDateString('pt-BR') %>
                                <% if (new Date(task.due_date) < new Date() && !task.completed) { %>
                                    ‚ö†Ô∏è Atrasada
                                <% } %>
                            </span>
                        </div>
                    <% } %>
                </div>
            </div>

            <!-- A√ß√µes R√°pidas -->
            <div class="card">
                <h3>‚ö° A√ß√µes R√°pidas</h3>
                <div class="quick-actions">
                    <form action="/tasks/toggle/<%= task.id %>" method="POST" style="display: inline;">
                        <button type="submit" class="btn <%= task.completed ? 'btn-warning' : 'btn-success' %>">
                            <%= task.completed ? '‚Ü©Ô∏è Reabrir Tarefa' : '‚úÖ Marcar como Conclu√≠da' %>
                        </button>
                    </form>
                    
                    <form action="/tasks/delete/<%= task.id %>" method="POST" style="display: inline;" 
                          onsubmit="return confirm('Tem certeza que deseja excluir esta tarefa? Esta a√ß√£o n√£o pode ser desfeita.')">
                        <button type="submit" class="btn btn-danger">
                            üóëÔ∏è Excluir Tarefa
                        </button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
